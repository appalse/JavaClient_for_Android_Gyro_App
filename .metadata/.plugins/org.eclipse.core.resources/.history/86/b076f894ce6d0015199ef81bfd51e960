import java.net.*;
import java.io.*;

public class ClientMain {

	private static Logger logger;
	private static Socket s;
	//private static String serverIpAddress = "192.168.0.106"; 
	private static String serverIpAddress = "176.14.245.232";

	public static void main(String[] args) {
		logger = Logger.GetLogger();
		
		int serverPort[] = { 12346, 12347 };	
		try{
			if( !attemptToOpen( serverPort[0] ) ) {
				if( !attemptToOpen( serverPort[1] ) ) {
					throw new Exception("Cannot open connection");					
				}
			}
			while(true){
				if(s.isClosed()){
					logger.WriteLine("socket is closed");
					break;
				}
				InputStream is = s.getInputStream();
				byte buf[] = new byte[64*1024];
				int r = is.read(buf);
				String data = new String(buf, 0, r);
				logger.WriteLine( data );	
				
				Thread.sleep(2000);
			}
		} catch(Exception e) {
			logger.WriteLine( e.getMessage() );
		}
	}
	
	private static boolean attemptToOpen( int port ) {
		boolean result = false;
		try{
			s = new Socket(serverIpAddress, port);
			result =  true;
		}catch(Exception e) {
			logger.WriteLine( e.getMessage() );
		}	
		return result;
	}

}
